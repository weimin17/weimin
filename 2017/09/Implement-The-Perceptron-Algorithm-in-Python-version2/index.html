<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="weimin" />



<meta name="description" content="CIS731: HW1-The Perceptron Model &amp; WinsorizationHW1: Explore whether Winsorizing (replacing extremely high values by predetermined upper&#x2F;lower bounds) can improve the accuracy or computational eff">
<meta property="og:type" content="article">
<meta property="og:title" content="Implement The Perceptron Algorithm in Python-version2">
<meta property="og:url" content="http://weimin17.github.io/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/index.html">
<meta property="og:site_name" content="A DL&#x2F;ML Learner">
<meta property="og:description" content="CIS731: HW1-The Perceptron Model &amp; WinsorizationHW1: Explore whether Winsorizing (replacing extremely high values by predetermined upper&#x2F;lower bounds) can improve the accuracy or computational eff">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-09-19T06:21:00.000Z">
<meta property="article:modified_time" content="2017-09-27T05:37:01.000Z">
<meta property="article:author" content="weimin">
<meta property="article:tag" content="Perceptron">
<meta property="article:tag" content="Neuron Netwrok">
<meta name="twitter:card" content="summary">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="A DL/ML Learner" type="application/atom+xml">



    <link rel="shortcut icon" href="/Coding.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-center-atom.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Implement The Perceptron Algorithm in Python-version2 | A DL/ML Learner</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 4.2.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar_idea.jpeg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">weimin</a></h1>
        </hgroup>

        
        <p class="header-subtitle">Train like a beast.</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="true" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">Homepage</a></li>
                        
                            <li><a href="/archives/">Archives</a></li>
                        
                            <li><a href="/tags/">Tags</a></li>
                        
                            <li><a href="/about/">About Me</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:insistweiminlv@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="https://github.com/weimin17" target="_blank" rel="noopener" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Action-Recognition/" rel="tag">Action Recognition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/" rel="tag">CNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deep-Learning/" rel="tag">Deep Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LSTM/" rel="tag">LSTM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Learning-Notes/" rel="tag">Learning Notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/" rel="tag">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Neuron-Network/" rel="tag">Neuron Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Neuron-Netwrok/" rel="tag">Neuron Netwrok</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/" rel="tag">Numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Optiminzation/" rel="tag">Optiminzation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Perceptron/" rel="tag">Perceptron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RNN/" rel="tag">RNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reading-List/" rel="tag">Reading List</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Video-QA/" rel="tag">Video QA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VideoQA/" rel="tag">VideoQA</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://github.com/weimin17/" target="_blank" rel="noopener">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/" target="_blank" rel="noopener">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Train like a monster.</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">weimin</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar_idea.jpeg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">weimin</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Train like a beast.</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">Homepage</a></li>
                
                    <li><a href="/archives/">Archives</a></li>
                
                    <li><a href="/tags/">Tags</a></li>
                
                    <li><a href="/about/">About Me</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:insistweiminlv@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/weimin17" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-Implement-The-Perceptron-Algorithm-in-Python-version2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/" class="article-date">
      <time datetime="2017-09-19T06:21:00.000Z" itemprop="datePublished">2017-09-19</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Implement The Perceptron Algorithm in Python-version2
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Machine-Learning/">Machine Learning</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Neuron-Netwrok/" rel="tag">Neuron Netwrok</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Perceptron/" rel="tag">Perceptron</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="CIS731-HW1-The-Perceptron-Model-amp-Winsorization"><a href="#CIS731-HW1-The-Perceptron-Model-amp-Winsorization" class="headerlink" title="CIS731: HW1-The Perceptron Model &amp; Winsorization"></a>CIS731: HW1-The Perceptron Model &amp; Winsorization</h1><p>HW1: Explore whether Winsorizing (replacing extremely high values by predetermined upper/lower bounds) can improve the accuracy or computational effort of a single-node classification algorithm (e.g., perceptron), experimenting with any non-trivial two-class data set.</p>
<p>This homework contains three parts: <br /><br>Part1: Algorithm Description<br /><br>Part2: Codes and Results<br /><br>Part3: The complete code (in “HW1_Perceptron.py”)</p>
<a id="more"></a>
<h1 id="1-Algorithm-Description-Single-Layer-Perceptron-Algorithm"><a href="#1-Algorithm-Description-Single-Layer-Perceptron-Algorithm" class="headerlink" title="1    Algorithm Description- Single-Layer Perceptron Algorithm"></a>1    Algorithm Description- Single-Layer Perceptron Algorithm</h1><h2 id="1-1-Activation-Function"><a href="#1-1-Activation-Function" class="headerlink" title="1.1    Activation Function"></a>1.1    Activation Function</h2><p><strong>This section introduces linear summation function and activation function.</strong><br/><br>The Perceptron receives input signals from training data, then combines the input vector and weight vector with a linear summation.</p>
<p><strong>Linear summation function:</strong></p>
<center>function=Weight*InputVector+Bias</center><br/>
The activation function then transformed into a prediction using a transfer function (Score function)—step function.<br />
__Step function: __<br />

<h2 id="1-2-Training-Perceptron"><a href="#1-2-Training-Perceptron" class="headerlink" title="1.2 Training Perceptron"></a>1.2 Training Perceptron</h2><p>In this section, it trains the perceptron model, which contains: 1.The feed forward algorithm is introduced. 2.Updating weights and bias using delta rule.<br/></p>
<h4 id="1-2-1-Feed-Forward"><a href="#1-2-1-Feed-Forward" class="headerlink" title="1.2.1 Feed Forward"></a>1.2.1 Feed Forward</h4><p>After defining activation function and transfer function, the second step for training a neuron network is to build a function which can make predictions using feed forward algorithm. </p>
<h4 id="1-2-2-Updating-Weights-and-bias"><a href="#1-2-2-Updating-Weights-and-bias" class="headerlink" title="1.2.2 Updating Weights and bias"></a>1.2.2 Updating Weights and bias</h4><p>In “feed forward” process, it needs initial weights and updated weights.<br/><br>1.Firstly, initializing weights and bias to zero vector: <br/></p>
<center>the “weights” vector= [bias, weight1, weight2, …, weight n] n is the number of features</center><br/>

<p>2.Secondly, when updating weights and bias using delta rule. <br/><br>Uses Error=(Actual - Predicted) before the predicted value goes through the threshold in the learning rule to decide weight update:<br/></p>
<center>Δw =  (learning rate) (Actual - Predicted)(inputvector)</center><br/>
When training the neuron network, there are three loops:<br/>
+ Circulate in each epoch<br/>
+ Circulate in each row in the training data for an epoch<br/>
+ Circulate in each weight and bias, and update it for a row in an epoch<br/>
#### 1.3 Evaluating Classification Performance Using a Cross Validation Split

<p>In this section, the homework uses the classification accuracy and validation to evaluate the model performance. It contains two functions: “accuracy_ACC” and “cross_validation_evaluation”.</p>
<h6 id="1-3-1-Accuracy"><a href="#1-3-1-Accuracy" class="headerlink" title="1.3.1 Accuracy"></a>1.3.1 Accuracy</h6><p>For a two-class problem, when “positive” vs “negative” classes are identified:</p>
<p>P: Positive; TP: True Positive; FP=P-TP: False Positive<br/><br>N: Negative; TN: True Negative; FN=N-TN: False Negative</p>
<p>Using classification accuracy to evaluate classification performance:</p>
<center>Classification accuracy (ACC)= (TP+TN)/(P+N)</center>

<h6 id="1-3-2-Using-Cross-Validation-Split"><a href="#1-3-2-Using-Cross-Validation-Split" class="headerlink" title="1.3.2 Using Cross Validation Split"></a>1.3.2 Using Cross Validation Split</h6><p>In order to evaluate the performance better, this homework uses cross validation. The performance is estimated by mean classification accuracy.</p>
<ol>
<li><p>Splitting a dataset.</p>
</li>
<li><p>Evaluating the Perceptron model using mean accuracy.</p>
</li>
</ol>
<h4 id="1-4-Winsorizing"><a href="#1-4-Winsorizing" class="headerlink" title="1.4 Winsorizing"></a>1.4 Winsorizing</h4><p>Due to the extreme values in the statistical data, the winsorizing is applied to reduce the effect of possibly spurious outliers.</p>
<h4 id="1-5-Iris-Dataset"><a href="#1-5-Iris-Dataset" class="headerlink" title="1.5 Iris Dataset"></a>1.5 Iris Dataset</h4><p>Iris dataset is a very classic dataset in the pattern recognition field. The original data set contains 3 classes of 50 instances each, where each class refers to a type of iris plant. One class is linearly separable from the other 2; the latter are NOT linearly separable from each other.<br>Attribute Information:</p>
<ol>
<li><p>sepal length in cm </p>
</li>
<li><p>sepal width in cm </p>
</li>
<li><p>petal length in cm </p>
</li>
<li><p>petal width in cm </p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="left"><strong>Data Set Characteristics:</strong></th>
<th align="center">Multivariate</th>
<th align="center"><strong>Number of Instances:</strong></th>
<th align="center">150</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Attribute Characteristics:</strong></td>
<td align="center">Real</td>
<td align="center"><strong>Number of Attributes:</strong></td>
<td align="center">4</td>
</tr>
<tr>
<td align="left"><strong>Associated Tasks:</strong></td>
<td align="center">Classification</td>
<td align="center"><strong>Missing Values:</strong></td>
<td align="center">No</td>
</tr>
</tbody></table>
<p>You can learn more about this dataset at the UCI Machine Learning repository (<a href="https://archive.ics.uci.edu/ml/datasets/Iris" target="_blank" rel="noopener">https://archive.ics.uci.edu/ml/datasets/Iris</a> ).</p>
<h1 id="2-Codes-and-Results"><a href="#2-Codes-and-Results" class="headerlink" title="2    Codes and Results"></a>2    Codes and Results</h1><h2 id="2-1-Data-Pre-Processing"><a href="#2-1-Data-Pre-Processing" class="headerlink" title="2.1 Data Pre-Processing"></a>2.1 Data Pre-Processing</h2><p>Load the Iris Dataset using Pandas Library:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_csv(<span class="string">'https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data'</span>, header=<span class="literal">None</span>)</span><br><span class="line">df.tail()</span><br></pre></td></tr></table></figure>




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>Iris-virginica</td>
    </tr>
  </tbody>
</table>
</div>



<p>First, extract the second feature column (sepal width in cm) and the forth feature column (petal width in cm) of 100 training samples, and assign them to feature Maxtrix X, as Input vector. <em>(I will show the performance with other features in Section 2.5.)</em> The class labels correspond to the 50 Iris-Virginia and 50 Iris-Versicolor flowers.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">X = df.iloc[<span class="number">50</span>:<span class="number">150</span>, [<span class="number">1</span>, <span class="number">3</span>]].values</span><br></pre></td></tr></table></figure>

<p>Also, Convert the class labels into binary labels: 1-Versicolor, -1-Virginica.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = df.iloc[<span class="number">50</span>:<span class="number">150</span>, <span class="number">4</span>].values</span><br><span class="line">y = np.where(y == y[<span class="number">0</span>], <span class="number">1</span>, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure>

<p>Visualization: Using matplotlib to show the data in a two-dimensional scatter plot.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline </span><br><span class="line">plt.scatter(X[:<span class="number">50</span>, <span class="number">0</span>], X[:<span class="number">50</span>, <span class="number">1</span>], color=<span class="string">'red'</span>, marker=<span class="string">'o'</span>, label=<span class="string">'Versicolor'</span>)</span><br><span class="line">plt.scatter(X[<span class="number">50</span>:<span class="number">100</span>, <span class="number">0</span>], X[<span class="number">50</span>:<span class="number">100</span>, <span class="number">1</span>], color=<span class="string">'blue'</span>, marker=<span class="string">'x'</span>, label=<span class="string">'Virginica'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'sepal width in cm'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal width in cm'</span>)</span><br><span class="line">plt.legend(loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/matplotlib/collections.py:548: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if self._edgecolors == &apos;face&apos;:</code></pre><h2 id="2-2-Training-the-Perceptron-Model"><a href="#2-2-Training-the-Perceptron-Model" class="headerlink" title="2.2 Training the Perceptron Model"></a>2.2 Training the Perceptron Model</h2><p>Define the Perceptron:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Perceptron</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, rate=<span class="number">0.01</span>, niter=<span class="number">10</span>)</span>:</span></span><br><span class="line">        self.rate = rate</span><br><span class="line">        self.niter = niter</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, X, y)</span>:</span></span><br><span class="line">        <span class="string">"""Fit training data</span></span><br><span class="line"><span class="string">        X : Training vectors, X.shape : [#samples, #features]</span></span><br><span class="line"><span class="string">        y : Target values, y.shape : [#samples]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># weights</span></span><br><span class="line">        self.weight = np.zeros(<span class="number">1</span> + X.shape[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Number of misclassifications</span></span><br><span class="line">        self.errors = []  <span class="comment"># Number of misclassifications</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.niter):</span><br><span class="line">            err = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> xi, target <span class="keyword">in</span> zip(X, y):</span><br><span class="line">                delta_w = self.rate * (target - self.predict(xi))</span><br><span class="line">                self.weight[<span class="number">1</span>:] += delta_w * xi</span><br><span class="line">                self.weight[<span class="number">0</span>] += delta_w</span><br><span class="line">                err += int(delta_w != <span class="number">0.0</span>)</span><br><span class="line">            self.errors.append(err)</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">net_input</span><span class="params">(self, X)</span>:</span></span><br><span class="line">        <span class="string">"""Calculate net input"""</span></span><br><span class="line">        <span class="keyword">return</span> np.dot(X, self.weight[<span class="number">1</span>:]) + self.weight[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, X)</span>:</span></span><br><span class="line">        <span class="string">"""Return class label after unit step"""</span></span><br><span class="line">        <span class="keyword">return</span> np.where(self.net_input(X) &gt;= <span class="number">0.0</span>, <span class="number">1</span>, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure>

<p>Train the Perceptron Model:<br/><br>Epoch = 200,Learning rate = 0.01:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cross_validation <span class="keyword">import</span> train_test_split</span><br><span class="line">pred = Perceptron(<span class="number">0.01</span>, <span class="number">200</span>)</span><br><span class="line"><span class="comment"># use cross_validation</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="literal">None</span>)</span><br><span class="line">pred.fit(x_train, y_train)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;__main__.Perceptron at 0x108e229d0&gt;</code></pre><p>Plot the misclassification error for each epoch to check if the algorithm converged and found a decision boundary that separates the two Iris flower classes:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(range(<span class="number">1</span>, len(pred.errors) + <span class="number">1</span>), pred.errors, marker=<span class="string">'o'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Epochs'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Number of misclassifications'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>The number of misclassifications versus the number of epochs (iterations) as shown above. <strong>We can see that the misclasifications are getting down with epochs. The perceptron converged after the fifty epoch (iteration). So we set the iteration to 50.</strong></p>
<p>Calculate the ACC accuracy using cross validation.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cross_validation <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculating accuracy percentage using ACC</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">accuracy_ACC</span><span class="params">(actual, predicted)</span>:</span></span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(actual)):</span><br><span class="line">        <span class="keyword">if</span> actual[i] == predicted[i]:</span><br><span class="line">            correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> correct / float(len(actual)) * <span class="number">100.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Training the Perceptron Model</span></span><br><span class="line">pred = Perceptron(<span class="number">0.01</span>, <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">acc=[]<span class="comment"># Accuracy_ACC</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    <span class="comment"># use cross_validation</span></span><br><span class="line">    x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="literal">None</span>)</span><br><span class="line">    pred.fit(x_train, y_train)</span><br><span class="line">    acc.append(accuracy_ACC(y_test, pred.predict(x_test)))</span><br><span class="line">print(<span class="string">'Accuracy_ACC:'</span>)</span><br><span class="line">print(sum(acc)/len(acc))</span><br></pre></td></tr></table></figure>

<pre><code>Accuracy_ACC:
87.85</code></pre><p>The mean accuracy in 100 cross validation is 87.85%.<br /><br>The errors showing below mean: in every epoch, there are how many misclassifications. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pred.errors</span><br></pre></td></tr></table></figure>




<pre><code>[29,
 23,
 23,
 8,
 8,
 20,
 15,
 18,
 16,
 13,
 12,
 10,
 12,
 8,
 10,
 12,
 13,
 10,
 13,
 10,
 10,
 11,
 12,
 8,
 10,
 11,
 10,
 9,
 10,
 8,
 8,
 10,
 11,
 8,
 8,
 8,
 10,
 11,
 8,
 8,
 8,
 8,
 10,
 11,
 8,
 8,
 9,
 10,
 10,
 8]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pred.weight</span><br></pre></td></tr></table></figure>




<pre><code>array([ 0.32 ,  0.32 , -0.646])</code></pre><p>The bias and the weight of the model are shown above. So the model is:</p>
<center>$ y = 0.32 + 0.32 * feature1 -0.646* feature2 $</center>

<p> Now we’re able to classify the training samples perfectly.</p>
<h2 id="2-3-Visualization-The-decision-boundaries"><a href="#2-3-Visualization-The-decision-boundaries" class="headerlink" title="2.3 Visualization: The decision boundaries"></a>2.3 Visualization: The decision boundaries</h2><p>To visualize the decision boundaries for our 2D datasets, implement a small convenience function:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># visualize the boundaries via plot_decision_regions</span></span><br><span class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> ListedColormap</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_decision_regions</span><span class="params">(X, y, algorithm, resolution=<span class="number">0.02</span>)</span>:</span></span><br><span class="line">    <span class="comment"># setup marker generator and color map</span></span><br><span class="line">    markers = (<span class="string">'s'</span>, <span class="string">'x'</span>, <span class="string">'o'</span>, <span class="string">'^'</span>, <span class="string">'v'</span>)</span><br><span class="line">    colors = (<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'lightgreen'</span>, <span class="string">'gray'</span>, <span class="string">'cyan'</span>)</span><br><span class="line">    cmap = ListedColormap(colors[:len(np.unique(y))])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># plot the decision surface</span></span><br><span class="line">    x1_min, x1_max = X[:, <span class="number">0</span>].min() - <span class="number">1</span>, X[:, <span class="number">0</span>].max() + <span class="number">1</span></span><br><span class="line">    x2_min, x2_max = X[:, <span class="number">1</span>].min() - <span class="number">1</span>, X[:, <span class="number">1</span>].max() + <span class="number">1</span></span><br><span class="line">    xx1, xx2 = np.meshgrid(np.arange(x1_min, x1_max, resolution),</span><br><span class="line">                           np.arange(x2_min, x2_max, resolution))</span><br><span class="line">    Z = algorithm.predict(np.array([xx1.ravel(), xx2.ravel()]).T)</span><br><span class="line">    Z = Z.reshape(xx1.shape)</span><br><span class="line">    plt.contourf(xx1, xx2, Z, alpha=<span class="number">0.4</span>, cmap=cmap)</span><br><span class="line">    plt.xlim(xx1.min(), xx1.max())</span><br><span class="line">    plt.ylim(xx2.min(), xx2.max())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># plot class samples</span></span><br><span class="line">    <span class="keyword">for</span> idx, cl <span class="keyword">in</span> enumerate(np.unique(y)):</span><br><span class="line">        plt.scatter(x=X[y == cl, <span class="number">0</span>], y=X[y == cl, <span class="number">1</span>],</span><br><span class="line">                    alpha=<span class="number">0.8</span>, c=cmap(idx),</span><br><span class="line">                    marker=markers[idx], label=cl)</span><br></pre></td></tr></table></figure>

<p>Plot the decision regions:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plot_decision_regions(X, y, algorithm=pred)</span><br><span class="line">plt.xlabel(<span class="string">'sepal width [cm]'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal width [cm]'</span>)</span><br><span class="line">plt.legend(loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="2-4-Winsorizing"><a href="#2-4-Winsorizing" class="headerlink" title="2.4 Winsorizing"></a>2.4 Winsorizing</h2><p>Now, winsorizing the data and see if the results become better.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">X = df.iloc[<span class="number">50</span>:<span class="number">150</span>, [<span class="number">1</span>, <span class="number">3</span>]].values</span><br><span class="line">y = df.iloc[<span class="number">50</span>:<span class="number">150</span>, <span class="number">4</span>].values</span><br><span class="line">y = np.where(y == y[<span class="number">0</span>], <span class="number">1</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="comment">#Winsorizing</span></span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line"><span class="keyword">for</span> i, raw <span class="keyword">in</span> enumerate(X.T):</span><br><span class="line">    <span class="keyword">for</span> j, col <span class="keyword">in</span> enumerate(list(stats.mstats.winsorize(raw, limits=[<span class="number">0.05</span>, <span class="number">0.05</span>]))):</span><br><span class="line">        X.T[i][j] = col</span><br></pre></td></tr></table></figure>

<p>Repeat all the work in section 2.2:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Training the Perceptron Model</span></span><br><span class="line">pred = Perceptron(<span class="number">0.01</span>, <span class="number">50</span>)</span><br><span class="line">acc=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    <span class="comment"># use cross_validation</span></span><br><span class="line">    x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="literal">None</span>)</span><br><span class="line">    pred.fit(x_train, y_train)</span><br><span class="line">    acc.append(accuracy_ACC(y_test, pred.predict(x_test)))</span><br><span class="line">print(<span class="string">'Accuracy_ACC:'</span>)</span><br><span class="line">print(sum(acc)/len(acc))</span><br></pre></td></tr></table></figure>

<pre><code>Accuracy_ACC:
88.6</code></pre><p><strong>Now the accuracy has increased from 87.85 to 88.6. It turns out that winsorizing this Iris dataset could optimize the performance of the Perceptron Model.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(range(<span class="number">1</span>, len(pred.errors) + <span class="number">1</span>), pred.errors, marker=<span class="string">'o'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Epochs'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Number of misclassifications'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(pred.weight)</span><br></pre></td></tr></table></figure>

<pre><code>[ 0.42   0.292 -0.734]</code></pre><p>The bias and the weight of the model shows below.</p>
<center>$ y = 0.42 + 0.292 * feature1 -0.734* feature2 $</center>

<p>Plot the new decision regions:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Plot the decision regions</span></span><br><span class="line"><span class="comment"># 1-Versicolor, -1-Virginica</span></span><br><span class="line">plot_decision_regions(X, y, algorithm=pred)</span><br><span class="line">plt.xlabel(<span class="string">'sepal width [cm]'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal width [cm]'</span>)</span><br><span class="line">plt.legend(loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h2 id="2-5-Comparing-the-winsorization-performance-with-different-number-of-features"><a href="#2-5-Comparing-the-winsorization-performance-with-different-number-of-features" class="headerlink" title="2.5 Comparing the winsorization performance with different number of features"></a>2.5 Comparing the winsorization performance with different number of features</h2><p>This section compares different situations of winsorization. The original Iris data has four features: <br/><br>Features Information:<br/></p>
<ol>
<li>sepal length in cm <br/></li>
<li>sepal width in cm <br/></li>
<li>petal length in cm <br/></li>
<li>petal width in cm <br/></li>
</ol>
<p>I use the second and the forth features to build my perceptron model and evaluate the results below. In this section, I also use three features:1,2,3 and all of fours features to build the model and evaluate the results.<br/></p>
<h4 id="2-5-1-Build-Model-with-first-three-features"><a href="#2-5-1-Build-Model-with-first-three-features" class="headerlink" title="2.5.1 Build Model with first three features"></a>2.5.1 Build Model with first three features</h4><ol>
<li>I have used first three features to build the Perceptron Model, but the performance is worse. <br/></li>
</ol>
<p><strong>Accuracy_ACC: 83.75</strong><br/><br><strong>Misclassifications:</strong><br/><br>[40, 30, 26, 18, 32, 32, 23, 26, 17, 17, 25, 17, 26, 16, 20, 19, 16, 15, 9, 14, 18, 16, 15, 9, 17, 16, 13, 9, 17, 14, 9, 15, 14, 7, 14, 9, 13, 14, 9, 14, 7, 15, 14, 9, 13, 12, 7, 14, 7, 15]<br/><br><strong>Bias+Weights:</strong><br/><br>[ 0.94   1.312  0.864 -2.238]<br/></p>
<center>$ y = 0.94 + 1.312 * feature1 + 0.864 * feature2 - 2.238 * feature3 $</center><br/>
The mean accuracy in 100 times cross validation is only 83.75%.

<ol start="2">
<li>After winsorizing<br/></li>
</ol>
<p><strong>Accuracy_ACC: 84.0</strong><br/><br><strong>Misclassifications:</strong><br/><br>[30, 34, 18, 15, 32, 28, 28, 21, 26, 21, 22, 17, 20, 17, 12, 19, 18, 17, 16, 16, 15, 14, 18, 13, 15, 13, 15, 13, 15, 10, 18, 13, 13, 13, 13, 13, 13, 13, 12, 12, 10, 14, 10, 13, 13, 13, 13, 13, 13, 13]<br/><br><strong>Bias+Weights:</strong><br/><br>[ 1.16   1.122  1.094 -2.424]<br/></p>
<center>$ y = 1.16 + 1.122 * feature1 + 1.094 * feature2 - 2.424 * feature3 $</center><br/>

<h4 id="2-5-2-Build-Model-with-all-of-four-features"><a href="#2-5-2-Build-Model-with-all-of-four-features" class="headerlink" title="2.5.2 Build Model with all of four features"></a>2.5.2 Build Model with all of four features</h4><ol>
<li>Before Winsorizing<br/></li>
</ol>
<p><strong>Accuracy_ACC: 89.05</strong><br/><br><strong>Misclassifications:</strong><br/><br>[34, 26, 28, 26, 18, 21, 26, 26, 20, 19, 16, 12, 16, 12, 20, 18, 11, 15, 12, 16, 13, 11, 15, 12, 16, 8, 13, 11, 8, 11, 11, 8, 13, 10, 9, 11, 10, 12, 9, 11, 10, 11, 10, 11, 10, 11, 10, 11, 8, 6]<br/><br><strong>Bias+Weights:</strong><br/><br>[ 0.96   1.016  0.88  -1.392 -2.108]<br/></p>
<center>$ y = 0.96 + 1.016 * feature1 + 0.88 * feature2 - 1.392 * feature3 - 2.108 * feature4$</center><br/>
2. After Winsorizing<br/>
**Accuracy_ACC: 90.25**<br/>
**Misclassifications:**<br/>
[35, 25, 28, 11, 21, 17, 17, 10, 15, 15, 15, 15, 13, 15, 15, 13, 15, 13, 13, 13, 13, 13, 13, 13, 15, 4, 15, 4, 15, 4, 15, 6, 11, 13, 4, 13, 4, 13, 4, 13, 4, 13, 4, 15, 6, 13, 6, 13, 4, 15]<br/>
**Bias+Weights:**<br/>
[ 0.84   1.238  0.52  -1.57  -1.514]<br/>
<center>$ y = 0.84 + 1.238 * feature1 + 0.52 * feature2 - 1.57 * feature3 - 1.514 * feature4$</center><br/>
To clearly compare the results, I show the mean accuracy in 100 times cross valications with different numbers of featuers. Before winsorizing and after winsorizing the data, the performance shows below:<br/>

<table>
<thead>
<tr>
<th align="left"><strong>Number of Features:</strong></th>
<th align="center"><strong>Before</strong></th>
<th align="center"><strong>After</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Two</strong></td>
<td align="center"><strong>87.85</strong></td>
<td align="center"><strong>88.6</strong></td>
</tr>
<tr>
<td align="left"><strong>Three</strong></td>
<td align="center"><strong>83.75</strong></td>
<td align="center"><strong>84.0</strong></td>
</tr>
<tr>
<td align="left"><strong>Four</strong></td>
<td align="center"><strong>89.05</strong></td>
<td align="center"><strong>90.25</strong></td>
</tr>
</tbody></table>
<p><strong>The table shows that after winsorizing, the performance of the Perceptron Model improves.</strong><br/></p>
<h2 id="2-6-Other-explainations"><a href="#2-6-Other-explainations" class="headerlink" title="2.6 Other explainations"></a>2.6 Other explainations</h2><ol>
<li>In this work, I use Iris flowers “Virginica” and “Versicolor”. I also tried “Setosa” and “Versicolor” as two class - with the same two features. The results are shown below. Without winsorizing, the results are perfect. In this way, I can not prove the effect of the winsorization. So I use the present two kind of flowers to build my project. <br/><br/></li>
</ol>
<p><strong>Mean Accuracy of 100 cross validation using “Setosa” and “Versicolor” eaquels 99% without winsorizing. The decision region is also perfect divided:</strong><br/><br>2. The accuracy of each perceptron model is very different. For example, if I set the cross validation times to 10, then the result (mean accuracy of 10 times cross validation) is not stable, sometimes it is larger, sometimes it is smaller. So I set the times of cross validation to 100. <br/><br>In this work, I randomly split 20% of the dataset as test data and the rest of the dataset as train data.</p>
<!--more-->

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/">Implement The Perceptron Algorithm in Python-version2</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">weimin</a></p>
        <p><span>Created:</span>2017-09-19, 02:21:00</p>
        <p><span>Updated:</span>2017-09-27, 01:37:01</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/" title="Implement The Perceptron Algorithm in Python-version2">http://weimin17.github.io/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/</a>
            <span class="copy-path" data-clipboard-text="From http://weimin17.github.io/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/　　By weimin" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/09/Deep-Learning-Recurrent-Neural-Networks-RNN/">
                    [Deep Learning] Recurrent Neural Networks - RNN
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/09/Numpy%E5%BA%94%E7%94%A8/">
                    Numpy应用
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CIS731-HW1-The-Perceptron-Model-amp-Winsorization"><span class="toc-text">CIS731: HW1-The Perceptron Model &amp; Winsorization</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Algorithm-Description-Single-Layer-Perceptron-Algorithm"><span class="toc-text">1    Algorithm Description- Single-Layer Perceptron Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-Activation-Function"><span class="toc-text">1.1    Activation Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Training-Perceptron"><span class="toc-text">1.2 Training Perceptron</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-Feed-Forward"><span class="toc-text">1.2.1 Feed Forward</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-Updating-Weights-and-bias"><span class="toc-text">1.2.2 Updating Weights and bias</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-3-1-Accuracy"><span class="toc-text">1.3.1 Accuracy</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#1-3-2-Using-Cross-Validation-Split"><span class="toc-text">1.3.2 Using Cross Validation Split</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-Winsorizing"><span class="toc-text">1.4 Winsorizing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-Iris-Dataset"><span class="toc-text">1.5 Iris Dataset</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Codes-and-Results"><span class="toc-text">2    Codes and Results</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Data-Pre-Processing"><span class="toc-text">2.1 Data Pre-Processing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Training-the-Perceptron-Model"><span class="toc-text">2.2 Training the Perceptron Model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-Visualization-The-decision-boundaries"><span class="toc-text">2.3 Visualization: The decision boundaries</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-Winsorizing"><span class="toc-text">2.4 Winsorizing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-Comparing-the-winsorization-performance-with-different-number-of-features"><span class="toc-text">2.5 Comparing the winsorization performance with different number of features</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1-Build-Model-with-first-three-features"><span class="toc-text">2.5.1 Build Model with first three features</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-Build-Model-with-all-of-four-features"><span class="toc-text">2.5.2 Build Model with all of four features</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-Other-explainations"><span class="toc-text">2.6 Other explainations</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

    <script>
        yiliaConfig.toc = ["Hide", "Show", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Implement The Perceptron Algorithm in Python-version2　| A DL/ML Learner　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://weimin17.github.io/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/';
            this.page.identifier = '2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//weimin17.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/09/Deep-Learning-Recurrent-Neural-Networks-RNN/" title="Pre: [Deep Learning] Recurrent Neural Networks - RNN">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/09/Numpy%E5%BA%94%E7%94%A8/" title="Next: Numpy应用">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/12/Brief-Introductions-of-Selected-Research-Weimin-Lyu-Lv/">Brief Introductions of Selected Research | Littlekoala</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/LearningNotes-Deep-Visual-Semantic-Alignments-for-Generating-Image-Descriptions-2015CVPR/">[LearningNotes]Deep Visual-Semantic Alignments for Generating Image Descriptions(2015CVPR)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/LearningNotew-LearningNotes-Explainable-Prediction-of-Medical-Codes-from-Clinical-Text/">[LearningNotes][LearningNotes]Explainable Prediction of Medical Codes from Clinical Text</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/LearningNotes-TieNet-Text-Image-Embedding-Network-for-Common-Thorax-Disease-Classification-and-Reporting-in-Chest-X-rays-2018CVPR/">[LearningNotes]TieNet Text-Image Embedding Network for Common Thorax Disease Classification and Reporting in Chest X-rays(2018CVPR)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/Learning-Notes-Math-Scheduling-with-Predictable-Link-Reliability-for-Wireless-Networked-Control/">[Learning Notes-Math] Scheduling with Predictable Link Reliability for Wireless Networked Control</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/Learning-Notes-Velocity-Optimization-of-Pure-Electric-Vehicles-with-Traffic-Dynamics-Consideration/">[Learning Notes] Velocity Optimization of Pure Electric Vehicles with Traffic Dynamics Consideration</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/Learning-Notes-Math-First-order-Stochastic-Algorithms-for-Escaping-From-Saddle-Points-in-Almost-Linear-Time/">[Learning Notes-Math] First-order Stochastic Algorithms for Escaping From Saddle Points in Almost Linear Time</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Deep-Learning-Warehouse/">Deep Learning Warehouse</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Reading-List-Visual-Question-and-Answering-Video-QA-Image-QA/">[Reading List] Visual Question and Answering (Video QA & Image QA)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Learning-Notes-Sequence-to-sequence-Learning-with-Neural-Networks/">[Learning Notes] Sequence to sequence Learning with Neural Networks</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Learning-Notes-Convolutional-LSTM-Network-A-Machine-Learning-Approach-for-Precipitation-Nowcasting/">[Learning Notes] Convolutional LSTM Network: A Machine Learning Approach for Precipitation Nowcasting</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Un-Learning-Notes-End-to-end-Concept-Word-Detection-for-Video-Captioning-Retrieval-and-Question-Answeringtitled/">Un[Learning Notes] End-to-end Concept Word Detection for Video Captioning, Retrieval and Question Answeringtitled</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Embedding/">[Deep Learning] Embedding</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Residual-Connect/">[Deep Learning] Residual Connect</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Gated-Linear-Unit/">[Deep Learning] Gated Linear Unit</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Attention-Mechanism/">[Deep Learning] Attention Mechanism</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Extensions-of-Recurrent-Neural-Networks/">[Deep Learning] Extensions of Recurrent Neural Networks</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Seq2Seq/">[Deep Learning] Seq2Seq</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Convolutional-Neural-Networks-CNN/">[Deep Learning] Convolutional Neural Networks - CNN</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Long-Short-Term-Memory-LSTM-Networks/">[Deep Learning] Long Short Term Memory - (LSTM) Networks</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Encoder-Decoder-Model/">[Deep Learning] Encoder-Decoder Model</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Learning-Notes-Quo-Vadis-Action-Recognition-A-New-Model-and-the-Kinetics-Dataset/">[Learning Notes] Quo Vadis, Action Recognition? A New Model and the Kinetics Dataset </a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Deep-Learning-Kernel/">[Deep Learning] Kernel</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/">[Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Deep-Learning-Recurrent-Neural-Networks-RNN/">[Deep Learning] Recurrent Neural Networks - RNN</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/">Implement The Perceptron Algorithm in Python-version2</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Numpy%E5%BA%94%E7%94%A8/">Numpy应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/%E7%AC%94%E8%AE%B0A-New-Representation-of-Skeleton-Sequences-for-3D-Action-Recognition/">[Learning notes] A New Representation of Skeleton Sequences for 3D Action Recognition</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version1/">Implement The Perceptron Algorithm in Python-version1</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Learning-Notes-A-New-Representation-of-Skeleton-Sequences-for-3D-Action-Recognition/">[Learning Notes]A New Representation of Skeleton Sequences for 3D Action Recognition</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Mac-Using-Github-Hexo-to-build-personal-blog-2/">Mac: Using Github+Hexo to build personal blog(2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Mac-Github-Hexo-to-build-personal-blog/">Mac: Using Github+Hexo to build personal blog(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/hello-world/">Hello World</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2017-2020 weimin
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
    
<script src="/js/GithubRepoWidget.js"></script>


<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>