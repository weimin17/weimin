<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="weimin" />



<meta name="description" content="| 论文(Arxiv)     | Blog Post(FAIR) |  Code(Github)   |">
<meta property="og:type" content="article">
<meta property="og:title" content="[Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING">
<meta property="og:url" content="http://weimin17.github.io/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/index.html">
<meta property="og:site_name" content="A DL&#x2F;ML Learner">
<meta property="og:description" content="| 论文(Arxiv)     | Blog Post(FAIR) |  Code(Github)   |">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://weimin17.github.io/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/1506120945555.png">
<meta property="og:image" content="https://pic3.zhimg.com/v2-0cd3e337910a1fca234065fb0896a75a_b.png">
<meta property="og:image" content="http://img.blog.csdn.net/20170419103042289?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1Y2hvbmdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170419110415306?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1Y2hvbmdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://pic1.zhimg.com/v2-e304330c2dd915d7878641456d932684_b.png">
<meta property="og:image" content="http://d3kbpzbmcynnmx.cloudfront.net/wp-content/uploads/2015/12/Screen-Shot-2015-12-30-at-1.16.08-PM.png">
<meta property="og:image" content="http://d3kbpzbmcynnmx.cloudfront.net/wp-content/uploads/2015/12/Screen-Shot-2015-12-30-at-1.23.48-PM.png">
<meta property="og:image" content="https://data-sci.info/wp-content/uploads/2017/05/fair.gif">
<meta property="article:published_time" content="2017-09-27T04:55:00.000Z">
<meta property="article:modified_time" content="2017-10-16T17:44:57.000Z">
<meta property="article:author" content="weimin">
<meta property="article:tag" content="Deep Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://weimin17.github.io/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/1506120945555.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="A DL/ML Learner" type="application/atom+xml">



    <link rel="shortcut icon" href="/Coding.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-center-atom.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>[Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING | A DL/ML Learner</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 4.2.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar_idea.jpeg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">weimin</a></h1>
        </hgroup>

        
        <p class="header-subtitle">Train like a beast.</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="true" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">Homepage</a></li>
                        
                            <li><a href="/archives/">Archives</a></li>
                        
                            <li><a href="/tags/">Tags</a></li>
                        
                            <li><a href="/about/">About Me</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:insistweiminlv@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="https://github.com/weimin17" target="_blank" rel="noopener" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Action-Recognition/" rel="tag">Action Recognition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/" rel="tag">CNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deep-Learning/" rel="tag">Deep Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LSTM/" rel="tag">LSTM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Learning-Notes/" rel="tag">Learning Notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/" rel="tag">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Neuron-Network/" rel="tag">Neuron Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Neuron-Netwrok/" rel="tag">Neuron Netwrok</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/" rel="tag">Numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Optiminzation/" rel="tag">Optiminzation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Perceptron/" rel="tag">Perceptron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RNN/" rel="tag">RNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reading-List/" rel="tag">Reading List</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Video-QA/" rel="tag">Video QA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VideoQA/" rel="tag">VideoQA</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://github.com/weimin17/" target="_blank" rel="noopener">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/" target="_blank" rel="noopener">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Train like a monster.</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">weimin</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar_idea.jpeg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">weimin</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Train like a beast.</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">Homepage</a></li>
                
                    <li><a href="/archives/">Archives</a></li>
                
                    <li><a href="/tags/">Tags</a></li>
                
                    <li><a href="/about/">About Me</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:insistweiminlv@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/weimin17" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/" class="article-date">
      <time datetime="2017-09-27T04:55:00.000Z" itemprop="datePublished">2017-09-27</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      [Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Learning-Notes/">Learning Notes</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Deep-Learning/" rel="tag">Deep Learning</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>| 论文(<a href="https://arxiv.org/pdf/1705.03122.pdf" target="_blank" rel="noopener">Arxiv</a>)     | Blog Post(<a href="https://code.facebook.com/posts/1978007565818999/a-novel-approach-to-neural-machine-translation/" target="_blank" rel="noopener">FAIR</a>) |  Code(<a href="https://github.com/facebookresearch/fairseq" target="_blank" rel="noopener">Github</a>)   |</p>
<a id="more"></a>
<p>來自FAIR團隊這幾天出的基於純CNN架構翻譯機:Convolutional Sequence to Sequence Learning。 其結果跟Google最新的方法比較後重點結果如下:</p>
<p>英翻法產生翻譯(WMT English-&gt;French)速度的表現:</p>
<p>在GPU產生翻譯的速度上，FAIR用K40(比較爛的GPU)是Google用K80(比較好的GPU)的9.3倍。<br>在CPU產生翻譯速度上，FAIR(48 cores)就已經是Google(88 cores)的17(per cpu core basis)倍，且還是Google自家用TPU的2.7倍。</p>
<p>綜合翻譯的表現:<br>WMT 2014 English-French:進步1.5BLEU<br>WMT 2014 English-German:進步0.5BLEU<br>WMT 2016 English-Romanian:進步1.8BLEU<br>看這速度跟效能，算是不小的突破。那這到底是怎麼做的呢? 下圖是這個模型的大架構:<br><img src="./1506120945555.png" alt="Alt text|center|450*600"></p>
<p>因為這一篇涉及的知識有點廣，所以三部分做引導和補充相關閱讀資料，這個Model的主要有三個部分:</p>
<p>Encoder-Decoder(左上和左下)<br>Residual Connect(沒標出來)<br>Multi-Hop Attention(中間那塊)</p>
<h2 id="第一部分-Encoder-Decoder-Gated-Linear-Unit-1"><a href="#第一部分-Encoder-Decoder-Gated-Linear-Unit-1" class="headerlink" title="第一部分: Encoder Decoder: Gated Linear Unit[1]"></a>第一部分: Encoder Decoder: Gated Linear Unit[1]</h2><p>[1]<a href="https://arxiv.org/abs/1612.08083" target="_blank" rel="noopener">Daphine et.al “Language Modeling with Gated Convolutional Networks” 2016</a></p>
<p>目前语言模型主要基于RNN，这篇文章提出了一种新颖的语言模型，仿照LSTM中的门限机制，利用多层的CNN结构，每层CNN都加上一个输出门限。文章的主要贡献包括：</p>
<ol>
<li>提出一种新的门控机制</li>
<li>缓解梯度传播，降低梯度弥散等现象</li>
<li>相比LSTM，模型更加简单，收敛速度更快 </li>
</ol>
<p>模型的结构图如下所示： </p>
<p><img src="https://pic3.zhimg.com/v2-0cd3e337910a1fca234065fb0896a75a_b.png" alt="Alt text|center"></p>
<p>为了缓解梯度消失的问题，LSTM在RNN中引入门限机制：输入门，遗忘门和输出门。由于循环神经网络中每个时刻状态都不仅和输入相关，也和前一个时刻状态相关。所以在序列中无法并行化处理。这篇论文将门引入到CNN中，提出了一种新颖的模型：门限机制的卷积模型，并延续了CNN可以并行计算的优势。文中具体提出了GTU和GLU两种模型，并在实验阶段作了比较。这两个模型整体类似，主要是激活函数不一样。</p>
<p>其主要结构跟原始的CNN并无很大差异，只不过在卷积层引入了门控机制，将卷积层的输出变成了下面的公式，即一个没有非线性函数的卷积层输出*经过sigmod非线性激活函数的卷积层输出： </p>
<p><img src="http://img.blog.csdn.net/20170419103042289?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1Y2hvbmdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="Alt text|center"></p>
<p>其中W和V是不同的卷积核，卷积核宽度为k，输出通道数为n，b和c是偏置参数。上面公式中的后半部分，即有激活函数的卷积就是所谓的门控机制，其控制了X*W+b中哪些信息可以传入下一层。这里将其定义为Gated Linear Units (GLU).然后就可以将该模型进行堆叠，以捕获Long_Term memory。论文得出：GLU要比GTU好。</p>
<p><img src="http://img.blog.csdn.net/20170419110415306?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1Y2hvbmdl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="|center"></p>
<p>Dauphine在他的論文中有更清楚的圖和文字來說明如何用這樣的架構來達到更好的Language Model。簡單來說Gated Linear Unit會對同一個input word vector學出兩個representation，其中一個是用來決定哪些資訊要保留哪些要捨去。而且這個方法可以更有效讓Gradient Backpropogate。</p>
<p>通过下面两篇文章快速了解该论文:<br><a href="http://blog.csdn.net/liuchonge/article/details/70238350" target="_blank" rel="noopener">參考1</a>, <a href="https://zhuanlan.zhihu.com/p/24780258" target="_blank" rel="noopener">參考2</a></p>
<h2 id="第二部分-Residual-Connect-2"><a href="#第二部分-Residual-Connect-2" class="headerlink" title="第二部分: Residual Connect[2]"></a>第二部分: Residual Connect[2]</h2><p>[2]<a href="https://arxiv.org/abs/1512.03385" target="_blank" rel="noopener">He et.al. “Deep Residual Learning for Image Recognition”</a></p>
<p>這篇文章可以跟VGG文章一起看，VGG是暴力增加網絡層數，使得訓練效果達到很棒。但是需要很長的訓練時間。而本文提出的ResNet，構造了殘差方式，使得訓練速度、效果都達到很好的狀態。</p>
<p>一般来说越深的网络，越难被训练，Deep Residual Learning for Image Recognition中提出一种residual learning的框架，能够大大简化模型网络的训练时间，使得在可接受时间内，模型能够更深(152甚至尝试了1000)，该方法在ILSVRC2015上取得最好的成绩。「背景介紹：这篇文章是介绍Kaming He等人组成的微软亚洲研究院的队伍参加ILSVRC 2015比赛中所用的网络结构的论文，ResNet一出，简直是把ImageNet上的classification任务给做烂了，top5的正确率达到了惊人的96%以上，已经超过了人类的识别率，网络的层数达到了152层，甚至上千层（要知道2014年的VGGNet中的22层已经用very deep来形容了），目前人们应用的最广泛的也就是GoogLeNet、VGGNet和ResNet了。」</p>
<p>随着模型深度的增加，会产生以下问题：</p>
<ol>
<li>vanishing/exploding gradient，导致了训练十分难收敛，这类问题能够通过norimalized initialization 和intermediate normalization layers解决；</li>
<li>对合适的额深度模型再次增加层数，模型准确率会迅速下滑（不是overfit造成），training error和test error都会很高，相应的现象在CIFAR-10和ImageNet都有提及。</li>
</ol>
<p>为了解决因深度增加而产生的性能下降问题，作者提出下面一种结构来做residual learning：<br><img src="https://pic1.zhimg.com/v2-e304330c2dd915d7878641456d932684_b.png" alt="@ResNet結構|center|500*300"></p>
<p>这篇文章主要得改善就是对传统的卷积模型增加residual learning，通过残差优化来找到近似最优identity mappings。既然我们现在的网络训练方法难以训练处我们现在心中完美的模型（我们心中完美的就是新加层之后的表现很好，能够提高正确率），那么我们退一步，让我们的模型学到更容易学到的，稍差的模型。假设我们心目中的模型，新加的层本来要学到这样一个映射H(x)，现在我们降低要求，让他学到这样一个映射F(x):=H(x)-x，其中x为输入的数据，那么我们最初要学习的映射就是F(x)+x，我们假设学习F(x)比学H(x)要简单。这样一来我们训练一个这样的网络，每一层学习到F(x)的映射，然后我们人为的对在该层的输出加入原输入x。这其实就是ResNet的基本思路，思路简单，但作者能这么想，同时还有理论的支持（理论的支持在文章Related work部分)。理想的状态下问题就解决了，因为我们可以通過”shortcut connections”較容易實現F(x)+x。</p>
<p><a href="http://blog.csdn.net/lhanchao/article/details/64159046" target="_blank" rel="noopener">參考1</a>， <a href="https://zhuanlan.zhihu.com/p/23518167" target="_blank" rel="noopener">參考2</a>， <a href="http://jacobkong.github.io/posts/3085218970/" target="_blank" rel="noopener">參考3</a><br>這個方法其實是在2015 ResNet中提出的，目的是為了在訓練很深的神經網路時讓Gradient能夠更容易Backpropogate，其概念和實作可以參考這篇介紹。可以簡單想成是在很深的神經網路中，讓比較深的Gradient可以有一個捷徑直接往後丟以免再一步一步地傳遞過程中消失。</p>
<h2 id="第三部分-Seq-to-Seq"><a href="#第三部分-Seq-to-Seq" class="headerlink" title="第三部分: Seq to Seq"></a>第三部分: Seq to Seq</h2><p><a href="https://arxiv.org/pdf/1611.01576.pdf" target="_blank" rel="noopener">Quasi-Recurrent Neural Networks</a><br>将LSTM的门机制扩展成时间序列，关于Seq to Seq, 现在有RNN seq to seq，CNN Seq to Seq，以及介于两者之间的QRNN，此部分仅用于了解Seq的机制。</p>
<h2 id="第四部分-Multi-hop-Attention"><a href="#第四部分-Multi-hop-Attention" class="headerlink" title="第四部分: Multi-hop Attention"></a>第四部分: Multi-hop Attention</h2><p>首先要知道什么是attention。這裏兩篇博客，一篇宏觀介紹<a href="https://machinelearningmastery.com/attention-long-short-term-memory-recurrent-neural-networks/" target="_blank" rel="noopener">Attention in Long Short-Term Memory Recurrent Neural Networks</a>，一篇從較細角度介紹<a href="http://www.wildml.com/2016/01/attention-and-memory-in-deep-learning-and-nlp/" target="_blank" rel="noopener">Attention and Memory in Deep Learning and NLP</a>。<br>Some points in these two blogs:</p>
<ol>
<li><strong>Why Attention</strong></li>
</ol>
<p>The Encoder-Decoder architecture is popular because it has demonstrated state-of-the-art results across a range of domains.<br>A limitation of the architecture is that it encodes the input sequence to a <strong>fixed length internal representation</strong>. This imposes limits on the length of input sequences that can be reasonably learned and results in <strong>worse performance</strong> for very <strong>long input sequences</strong>.</p>
<p>Attention is the idea of freeing the encoder-decoder architecture from <em>the fixed-length internal representation</em> (Maybe to overcome the disadvantages of <em>long input sequences</em> is better). This is achieved by keeping the intermediate outputs from the encoder LSTM from each step of the input sequence and training the model to learn to pay selective attention to these inputs and relate them to items in the output sequence. Put another way, each item in the output sequence is conditional on selective items in the input sequence.</p>
<ol start="2">
<li><strong>If you look closely at the “Attention”</strong></li>
</ol>
<p>With an attention mechanism we no longer try encode the full source sentence into a fixed-length vector. Rather, we allow the decoder to “attend” to different parts of the source sentence at each step of the output generation. Importantly, we let the model learn what to attend to based on the input sentence and what it has produced so far.<br><img src="http://d3kbpzbmcynnmx.cloudfront.net/wp-content/uploads/2015/12/Screen-Shot-2015-12-30-at-1.16.08-PM.png" alt="@Neural Machine Translation by Jointly Learning to Align and Translate|center|300*300"></p>
<p>Here, The <code>y&#39;s</code> are our translated words produced by the decoder, and the <code>x&#39;s</code> are our source sentence words. The above illustration uses a bidirectional recurrent network, but that’s not important and you can just ignore the inverse direction. The important part is that each decoder output word y_t now depends on <strong>a weighted combination of all the input states</strong>, not just the last state. The a‘s are weights that define in how much of each input state should be considered for each output. So, if $a_{3,2}$ is a large number, this would mean that the decoder pays a lot of attention to the second state in the source sentence while producing the third word of the target sentence. The <code>a&#39;s</code> are typically normalized to sum to 1 (so they are a distribution over the input states).</p>
<p>A big advantage of attention is that it gives us the ability to interpret and visualize what the model is doing. For example, by visualizing the attention weight matrix a when a sentence is translated, we can understand how the model is translating:</p>
<p><img src="http://d3kbpzbmcynnmx.cloudfront.net/wp-content/uploads/2015/12/Screen-Shot-2015-12-30-at-1.23.48-PM.png" alt="@Visualization| center| 300*300"></p>
<ol start="3">
<li><strong>Disadvantages</strong></li>
</ol>
<p>This increases the computational burden of the model, but results in a more targeted and better-performing model.</p>
<p>在Convolutional Seq to Seq這篇文章中，用到了Multi-Step Attention。這裡必需先提一下Attention在機器翻譯中的應用，直覺上來說就是在翻譯的過程中，回去看一下待翻譯句子的前後文，更多細節可以參考[3]或是這篇文章中的Attention部分。Multi-Hop直覺上來說就是多重複幾次這樣的動作來達到更好的翻譯表現，這部分FAIR做了一個簡單的圖:</p>
<p><img src="https://data-sci.info/wp-content/uploads/2017/05/fair.gif" alt="Fair"></p>
<p>圖片來源: <a href="https://research.fb.com/category/facebook-ai-research-fair/" target="_blank" rel="noopener">FAIR</a></p>
<p>這三塊都有基本了解後這篇大概就能看懂八成了。不過這篇文還有其他細節像是Normalization,Initialization都有特別設計過，就留待讀者自行去探索了。</p>
<!--more-->

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/">[Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">weimin</a></p>
        <p><span>Created:</span>2017-09-27, 00:55:00</p>
        <p><span>Updated:</span>2017-10-16, 13:44:57</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/" title="[Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING">http://weimin17.github.io/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/</a>
            <span class="copy-path" data-clipboard-text="From http://weimin17.github.io/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/　　By weimin" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/09/Deep-Learning-Kernel/">
                    [Deep Learning] Kernel
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/09/Deep-Learning-Recurrent-Neural-Networks-RNN/">
                    [Deep Learning] Recurrent Neural Networks - RNN
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第一部分-Encoder-Decoder-Gated-Linear-Unit-1"><span class="toc-text">第一部分: Encoder Decoder: Gated Linear Unit[1]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二部分-Residual-Connect-2"><span class="toc-text">第二部分: Residual Connect[2]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三部分-Seq-to-Seq"><span class="toc-text">第三部分: Seq to Seq</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第四部分-Multi-hop-Attention"><span class="toc-text">第四部分: Multi-hop Attention</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

    <script>
        yiliaConfig.toc = ["Hide", "Show", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"[Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING　| A DL/ML Learner　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://weimin17.github.io/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/';
            this.page.identifier = '2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//weimin17.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/09/Deep-Learning-Kernel/" title="Pre: [Deep Learning] Kernel">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/09/Deep-Learning-Recurrent-Neural-Networks-RNN/" title="Next: [Deep Learning] Recurrent Neural Networks - RNN">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/12/Brief-Introductions-of-Selected-Research-Weimin-Lyu-Lv/">Brief Introductions of Selected Research | Littlekoala</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/LearningNotes-Deep-Visual-Semantic-Alignments-for-Generating-Image-Descriptions-2015CVPR/">[LearningNotes]Deep Visual-Semantic Alignments for Generating Image Descriptions(2015CVPR)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/LearningNotew-LearningNotes-Explainable-Prediction-of-Medical-Codes-from-Clinical-Text/">[LearningNotes][LearningNotes]Explainable Prediction of Medical Codes from Clinical Text</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/LearningNotes-TieNet-Text-Image-Embedding-Network-for-Common-Thorax-Disease-Classification-and-Reporting-in-Chest-X-rays-2018CVPR/">[LearningNotes]TieNet Text-Image Embedding Network for Common Thorax Disease Classification and Reporting in Chest X-rays(2018CVPR)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/Learning-Notes-Math-Scheduling-with-Predictable-Link-Reliability-for-Wireless-Networked-Control/">[Learning Notes-Math] Scheduling with Predictable Link Reliability for Wireless Networked Control</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/Learning-Notes-Velocity-Optimization-of-Pure-Electric-Vehicles-with-Traffic-Dynamics-Consideration/">[Learning Notes] Velocity Optimization of Pure Electric Vehicles with Traffic Dynamics Consideration</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/Learning-Notes-Math-First-order-Stochastic-Algorithms-for-Escaping-From-Saddle-Points-in-Almost-Linear-Time/">[Learning Notes-Math] First-order Stochastic Algorithms for Escaping From Saddle Points in Almost Linear Time</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Deep-Learning-Warehouse/">Deep Learning Warehouse</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Reading-List-Visual-Question-and-Answering-Video-QA-Image-QA/">[Reading List] Visual Question and Answering (Video QA & Image QA)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Learning-Notes-Sequence-to-sequence-Learning-with-Neural-Networks/">[Learning Notes] Sequence to sequence Learning with Neural Networks</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Learning-Notes-Convolutional-LSTM-Network-A-Machine-Learning-Approach-for-Precipitation-Nowcasting/">[Learning Notes] Convolutional LSTM Network: A Machine Learning Approach for Precipitation Nowcasting</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/Un-Learning-Notes-End-to-end-Concept-Word-Detection-for-Video-Captioning-Retrieval-and-Question-Answeringtitled/">Un[Learning Notes] End-to-end Concept Word Detection for Video Captioning, Retrieval and Question Answeringtitled</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Embedding/">[Deep Learning] Embedding</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Residual-Connect/">[Deep Learning] Residual Connect</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Gated-Linear-Unit/">[Deep Learning] Gated Linear Unit</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Attention-Mechanism/">[Deep Learning] Attention Mechanism</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Extensions-of-Recurrent-Neural-Networks/">[Deep Learning] Extensions of Recurrent Neural Networks</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Seq2Seq/">[Deep Learning] Seq2Seq</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Convolutional-Neural-Networks-CNN/">[Deep Learning] Convolutional Neural Networks - CNN</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Long-Short-Term-Memory-LSTM-Networks/">[Deep Learning] Long Short Term Memory - (LSTM) Networks</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/Deep-Learning-Encoder-Decoder-Model/">[Deep Learning] Encoder-Decoder Model</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Learning-Notes-Quo-Vadis-Action-Recognition-A-New-Model-and-the-Kinetics-Dataset/">[Learning Notes] Quo Vadis, Action Recognition? A New Model and the Kinetics Dataset </a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Deep-Learning-Kernel/">[Deep Learning] Kernel</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Learning-Notes-CONVOLUTIONAL-SEQUENCE-TO-SEQUENCE-LEARNING/">[Learning Notes]CONVOLUTIONAL SEQUENCE TO SEQUENCE LEARNING</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Deep-Learning-Recurrent-Neural-Networks-RNN/">[Deep Learning] Recurrent Neural Networks - RNN</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version2/">Implement The Perceptron Algorithm in Python-version2</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Numpy%E5%BA%94%E7%94%A8/">Numpy应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/%E7%AC%94%E8%AE%B0A-New-Representation-of-Skeleton-Sequences-for-3D-Action-Recognition/">[Learning notes] A New Representation of Skeleton Sequences for 3D Action Recognition</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Implement-The-Perceptron-Algorithm-in-Python-version1/">Implement The Perceptron Algorithm in Python-version1</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Learning-Notes-A-New-Representation-of-Skeleton-Sequences-for-3D-Action-Recognition/">[Learning Notes]A New Representation of Skeleton Sequences for 3D Action Recognition</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Mac-Using-Github-Hexo-to-build-personal-blog-2/">Mac: Using Github+Hexo to build personal blog(2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/Mac-Github-Hexo-to-build-personal-blog/">Mac: Using Github+Hexo to build personal blog(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/hello-world/">Hello World</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2017-2020 weimin
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
    
<script src="/js/GithubRepoWidget.js"></script>


<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>